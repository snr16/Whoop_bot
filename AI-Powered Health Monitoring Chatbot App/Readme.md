# AI-Powered Health Monitoring Chatbot

## Overview
This project is an **AI-Powered Health Monitoring Chatbot** built with **Streamlit**, **Anthropic Claude (AI)**, **PostgreSQL**, and **Python visualizations** to analyze and visualize health data. Its functionalities include:

- **Querying a PostgreSQL database** using dynamic SQL queries generated from user prompts.
- **Providing Insights:**
   - Verbal summaries and interpretations of the queried data are generated by the Claude AI model.
- **Data Visualization:**
   - Visualization charts (bar charts, line charts, etc.) are dynamically created based on user requests.
- **Health Recommendations:**
   - Actionable suggestions and diet recommendations are generated using AI analysis of the health data.

It dynamically generates SQL queries, fetches data from a PostgreSQL database, and processes it using AI models for analysis and visualization.

---

## Features
1. **AI-Generated SQL Queries**:
   - Converts user prompts into SQL queries.
   - Fetches data from PostgreSQL tables dynamically.

2. **Health Insights**:
   - Claude AI generates verbal summaries and insights based on health data.

3. **Actionable Recommendations**:
   - Provides actionable health and **diet suggestions**.

4. **Data Visualizations**:
   - Generates visualizations dynamically using Python code (Matplotlib/Seaborn).

5. **Interactive UI**:
   - User-friendly chatbot interface with Streamlit.
   - Options to view insights, suggestions, and visual trends.

---

## Table of Contents
- [Project Structure](#project-structure)
- [Core Functionalities](#core-functionalities)
- [Setup Instructions](#setup-instructions)
- [How to Run](#how-to-run)
- [Example Queries](#example-queries)
- [Troubleshooting](#troubleshooting)

---

## Project Structure
The project is modular and includes the following components:

1. **Dependencies**: 
The following libraries are required:

- `streamlit`: For chatbot interface and UI components.
- `pandas`: For data manipulation and storage.
- `seaborn, matplotlib`: For visualizing the data.
- `psycopg2`: To connect and execute queries on the PostgreSQL database.
- `anthropic`: For generating SQL queries, insights, and recommendations using Claude AI.
- Additional utilities: `re`, `os`, `uuid`, `base64`, and `traceback`.

2. **Claude AI Integration**:
   - Generates SQL queries, insights, and health suggestions.
3. **PostgreSQL Integration**:
   - Queries data from the health database.
4. **Data Processing**:
   - Pandas for data manipulation and preprocessing.
5. **Visualization**:
   - Matplotlib and Seaborn for data visualization.
6. **Streamlit Interface**:
   - Interactive chatbot UI for user queries and output display.


## Core Functionalities

1. **Intent Parsing (`parse_intent`):**
  - Converts user queries into SQL queries using Claude AI.

2. **Query Execution (`execute_postgresql_query`):**
  - Runs SQL queries on a PostgreSQL database and returns results as a Pandas DataFrame.

3. **Insight Generation (`generate_insight`):**
  - Generates verbal insights from the data.

4. **Suggestions and Diet Recommendations:**
  - `generate_suggestions`: Provides actionable insights.
  - `generate_diet_suggestions`: Generates personalized diet advice.

5. **Dynamic Visualization:**
  - `generate_visualization_code`: AI generates Python visualization code.
  - `execute_visualization_and_save`: Executes and saves the visualization.

6. **Streamlit Interface:**
  - **User Input:** Accepts questions or requests.
  - **Dynamic Buttons:**
    - Generate Suggestions
    - Generate Diet Suggestions
    - Generate Visualization
  - **Conversation Management:** Maintains a history of user interactions.
---

## Setup Instructions

### Prerequisites
- Python 3.8 or higher
- PostgreSQL database setup
- Claude API Key (from Anthropic)
- Required libraries

### 1. Install Python Libraries
Run the following command to install all dependencies:
```bash
pip install streamlit anthropic pandas psycopg2-binary matplotlib seaborn streamlit-extras
```

### 2. PostgreSQL Setup
Ensure your PostgreSQL database is running and populated with the following tables:
- **users** (user_id, first_name, last_name, email)
- **sleep_data** (user_id, total_sleep_time, rem_sleep_time, deep_sleep_time, efficiency, timestamp, nap, respiratory_rate)
- **recovery_data** (cycle_id, user_id, recovery_score, resting_heart_rate, hrv_rmssd_milli, created_at)
- **cycle_data** (cycle_id, user_id, strain, kilojoule, average_heart_rate, max_heart_rate, created_at)
- **workout_data** (workout_id, user_id, strain, kilojoule, distance_meter, created_at)
- **body_measurements** (user_id, height_meter, weight_kilogram, max_heart_rate)

Modify `db_config` in the code with your PostgreSQL credentials:
```python
"database": "health_monitor_whoop",
"user": "YOUR_USERNAME",
"password": "YOUR_PASSWORD",
"host": "YOUR_HOST",
"port": "5432"
```

### 3. Obtain Anthropic API Key
Sign up for an API key from [Anthropic](https://www.anthropic.com). Replace the placeholder in the code:
```python
api_key = "YOUR_ANTHROPIC_API_KEY"
```

### 4. Place Required Images
Place the following files in the project directory:
- **Background Image**: `background.jpg`
- **Chatbot Image**: `bot.png`

---

## How to Run

1. Open a terminal or command prompt.
2. Navigate to the directory containing the code.
3. Run the Streamlit app:
   ```bash
   streamlit run app.py
   ```

4. Open the provided URL (e.g., `http://localhost:8501`) in your web browser.
5. Start interacting with the chatbot!

---

## Example Queries
Test the chatbot with the following queries:
1. **Heart Rate Analysis**:
   - "What was my average heart rate on the 5 most active days?"
2. **Sleep Analysis**:
   - "Did I get enough sleep this week?"
   - "How did my deep sleep change during my 5 most active days?"
3. **Workout Analysis**:
   - "How did my strain levels affect my recovery this month?"
4. **Diet Recommendations**:
   - "What diet suggestions can you give me for my health trends?"

---

## Troubleshooting

1. **Database Connection Error**:
   - Verify your PostgreSQL credentials and database accessibility.
   - Ensure the database tables are populated.

2. **API Key Errors**:
   - Ensure your Anthropic API key is correct and has not expired.
   - Check usage limits on the API key.

3. **Missing Libraries**:
   - Install libraries using:
     ```bash
     pip install -r requirements.txt
     ```

4. **Visualization Errors**:
   - Ensure your data has the correct columns and formats.
   - Dates should be in proper datetime format.

---


---

## License
This project is licensed under the MIT License.
